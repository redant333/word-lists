"use strict";function createWordListEntryNode(t,e,n){const o=document.getElementById("id_word_list_entry"),r=o.content.cloneNode(!0);return r.querySelector(".data-title").innerText=t,r.querySelector(".data-description").innerHTML=e,r.querySelectorAll(".data-link").forEach(t=>{t.href+=n}),r}function loadListEntries(r){fetch("/word-lists/data/index.json").then(t=>t.json()).then(t=>{const e=document.getElementById(r);for(const o of t){var n=createWordListEntryNode(o.title,o.description,o.listName);e.appendChild(n)}})}
"use strict";function listData(t,e){e="/word-lists/data/"+e,fetch(e).then(e=>e.json()).then(e=>{fillTable(t,e)})}function addHeader(e,t){const n=document.createElement("thead"),d=(e.appendChild(n),document.createElement("tr"));n.appendChild(d);for(const a of t){const o=document.createElement("th");o.setAttribute("scope","col"),o.innerText=a,d.appendChild(o)}}function fillTable(e,t){const n=document.getElementById(e);e=[...t.metadata.forms,...t.metadata.infos];addHeader(n,e);const d=document.createElement("tbody");n.appendChild(d);for(const o of t.list){const c=document.createElement("tr");d.appendChild(c);for(var a of o.flat()){const l=document.createElement("td");l.innerText=a,c.appendChild(l)}}}
"use strict";const STATE_GUESSING="STATE_GUESSING",STATE_SUCCESS="STATE_SUCCESS",STATE_FAILURE="STATE_FAILURE";function maybeIndex(t,e){e=t[e];return void 0!==e?e:t}class WordRandomizer{constructor(t,e){this._words=t,this._lastWordIndex=null,this._excludedGivenWords=e||[]}_randomInt(t){return Math.floor(Math.random()*t)}_getRandomWord(){let t=null;for(;t===this._lastWordIndex||null===t;)t=this._randomInt(this._words.length);this._lastWordIndex=t;let e=null;for(;null===e||"-"===this._words[t][0][e];)e=this._randomInt(this._words[t][0].length);let s=null;for(;s===e||null===s;)s=this._randomInt(this._words[t][0].length);let i=null;return this._words[t][0][e]instanceof Array&&(i=this._randomInt(this._words[t][0][e].length)),[t,i,e,s]}nextWord(){let t=null;do{var[e,s,i]=t=this._getRandomWord(),e=maybeIndex(this._words[e][0][i],s)}while(this._excludedGivenWords.includes(e));return t}}class PracticeStateMachine{constructor(t,e,s,i,n){this._wordRandomizer=n||new WordRandomizer(t,i),this._words=t,this._forms=e,this._infos=s,this._successCount=0,this._failureCount=0,this._state=null}get state(){return this._state}get wantedWords(){return this._wantedWords}get wantedWordAllInfos(){return this._wantedWordAllInfos}get wantedWordAllForms(){return this._wantedWordAllForms}get givenWord(){return this._givenWord}get givenForm(){return this._givenForm}get wantedForm(){return this._wantedForm}get successCount(){return this._successCount}get failureCount(){return this._failureCount}start(){var[e,t,s,i]=this._wordRandomizer.nextWord();this._wantedWords=[this._words[e][0][i]].flat(),this._wantedWordAllForms=[];for(let t=0;t<this._forms.length;t++)this._wantedWordAllForms.push([this._forms[t],[this._words[e][0][t]].flat()]);this._wantedWordAllInfos=[];for(let t=0;t<this._infos.length;t++)this._wantedWordAllInfos.push([this._infos[t],this._words[e][1][t]]);this._givenWord=maybeIndex(this._words[e][0][s],t),this._wantedForm=this._forms[i],this._givenForm=this._forms[s],this._state=STATE_GUESSING}guess(t){const e=this._wantedWords.map(t=>t.toLowerCase());e.includes(t.toLowerCase())?(this._state=STATE_SUCCESS,this._successCount++):(this._state=STATE_FAILURE,this._failureCount++)}}class Practice{constructor(t){this.dataFile="/word-lists/data/"+t}setControls(){function t(t){return document.getElementById(t)}this.sGivenWord=t("id_word"),this.sWantedWord=t("id_expected_word"),this.sGivenForm=t("id_given_form"),this.sWantedForm=t("id_wanted_form"),this.sWantedFormFailure=t("id_wanted_form_failure"),this.bCheck=t("id_check"),this.bNext=t("id_next"),this.iInput=t("id_input"),this.dSuccess=t("id_success"),this.dFailure=t("id_failure"),this.sSuccessCount=t("id_success_count"),this.sFailureCount=t("id_failure_count"),this.dAllForms=t("id_all_forms"),this.dAllInfos=t("id_all_infos")}start(){fetch(this.dataFile).then(t=>t.json()).then(t=>{this.stateMachine=new PracticeStateMachine(t.list,t.metadata.forms,t.metadata.infos,t.metadata.excludedGivenWords),this.stateMachine.start(),this.setControls(),this.setEventListeners(),this.adaptControlsToState()})}setEventListeners(){this.bCheck.addEventListener("click",()=>{this.handleInput()}),this.iInput.addEventListener("keyup",t=>{"Enter"===t.key&&this.stateMachine.state===STATE_GUESSING&&this.bCheck.click()}),this.bNext.addEventListener("click",()=>{this.stateMachine.start(),this.adaptControlsToState()})}handleInput(){var t=this.iInput.value.trim();""===t?this.iInput.focus():(this.stateMachine.guess(t),this.adaptControlsToState())}_createReferenceTableRow(t,e){const s=document.getElementById("id_reference_table_row"),i=s.content.cloneNode(!0);return i.querySelector(".data-name").innerText=t,i.querySelector(".data-value").innerText=e,i}adaptControlsToState(){if(this.stateMachine.state===STATE_GUESSING)return this.bNext.setAttribute("hidden",!0),this.bCheck.removeAttribute("hidden"),this.iInput.value="",this.iInput.removeAttribute("readonly"),this.iInput.placeholder=this.stateMachine.wantedForm,this.dFailure.setAttribute("hidden",!0),this.dSuccess.setAttribute("hidden",!0),this.sGivenForm.innerText=this.stateMachine.givenForm,this.sGivenWord.innerText=this.stateMachine.givenWord,this.sWantedForm.innerText=this.stateMachine.wantedForm,this.dAllForms.setAttribute("hidden",!0),this.dAllInfos.setAttribute("hidden",!0),void this.iInput.focus();if(this.stateMachine.state===STATE_SUCCESS||this.stateMachine.state===STATE_FAILURE){this.bNext.removeAttribute("hidden"),this.bCheck.setAttribute("hidden",!0),this.iInput.setAttribute("readonly",!0),this.sSuccessCount.innerText=this.stateMachine.successCount,this.sFailureCount.innerText=this.stateMachine.failureCount,this.dAllInfos.innerHTML="";for(var[t,e]of this.stateMachine.wantedWordAllInfos)this.dAllInfos.appendChild(this._createReferenceTableRow(t,e));this.dAllInfos.removeAttribute("hidden"),this.dAllForms.innerHTML="";for(var[s,i]of this.stateMachine._wantedWordAllForms)this.dAllForms.appendChild(this._createReferenceTableRow(s,i));this.dAllForms.removeAttribute("hidden"),this.bNext.focus()}this.stateMachine.state===STATE_SUCCESS?this.dSuccess.removeAttribute("hidden"):this.stateMachine.state===STATE_FAILURE&&(this.sWantedFormFailure.innerText=this.stateMachine.wantedForm,this.sWantedWord.innerText=this.stateMachine.wantedWords,this.dFailure.removeAttribute("hidden"))}}"undefined"!=typeof module&&(module.exports={STATE_GUESSING:STATE_GUESSING,STATE_SUCCESS:STATE_SUCCESS,STATE_FAILURE:STATE_FAILURE,WordRandomizer:WordRandomizer,PracticeStateMachine:PracticeStateMachine});